{% extends 'base.html' %}

{% block app_content %}
    {% include 'profile/_navbar.html' %}
    {% include '_flashed.html' %}
    <div class="container">
        <div class="row d-flex justify-content-center align-items-center">
            <div class="col-12 col-md-8 col-lg-6 col-xl-5">
                <h5 class="mb-4 text-center">Адреса доставки</h5>
                <button type="button" class="btn btn-primary btn-lg w-100 mb-5" data-bs-toggle="modal" data-bs-target="#AddressModal">
                    Добавить новый адрес
                </button>
                <div class="modal fade" id="AddressModal" tabindex="-1">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                            <div class="modal-header border-0">
                                <h5 class="modal-title" id="ModalLabel">Адрес доставки</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <form action="" method="post" novalidate>
                                    {{ address_form.hidden_tag() }}
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            {{ address_form.street.label(class_="form-label", for="InputStreet") }}
                                            {{ address_form.street(class_="form-control", id="InputStreet") }}
                                            {% for error in address_form.street.errors %}
                                                <span style="color: red;">{{ error }}</span>
                                            {% endfor %}
                                        </div>
                                        <div class="col-md-6">
                                            {{ address_form.house.label(class_="form-label", for="InputHouse") }}
                                            {{ address_form.house(class_="form-control", id="InputHouse") }}
                                            {% for error in address_form.house.errors %}
                                                <span style="color: red;">{{ error }}</span>
                                            {% endfor %}
                                        </div>
                                        <div class="col-md-6">
                                            {{ address_form.building.label(class_="form-label", for="InputBuilding") }}
                                            {{ address_form.building(class_="form-control", id="InputBuilding") }}
                                        </div>
                                        <div class="col-md-6">
                                            {{ address_form.entrance.label(class_="form-label", for="InputEntrance") }}
                                            {{ address_form.entrance(class_="form-control", id="InputEntrance") }}
                                        </div>
                                        <div class="col-md-6">
                                            {{ address_form.floor.label(class_="form-label", for="InputFloor") }}
                                            {{ address_form.floor(class_="form-control", id="InputFloor") }}
                                        </div>
                                        <div class="col-md-6">
                                            {{ address_form.apartment.label(class_="form-label", for="InputApartment") }}
                                            {{ address_form.apartment(class_="form-control", id="InputApartment") }}
                                        </div>
                                        <div class="col-12">
                                            {{ address_form.additional_info.label(class_="form-label", for="InputAdditionalInfo") }}
                                            {{ address_form.additional_info(class_="form-control", id="InputAdditionalInfo") }}
                                        </div>
                                    </div>
                                    <div class="modal-footer border-0">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть</button>
                                        {{ address_form.submit_address(class_="btn btn-primary") }}
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <h5 class="mb-4 text-center">Мои адреса</h5>
                {% for address in current_user.addresses %}
                    <div class="card mb-2">
                        <div class="card-body">
                            <div class="row align-items-center text-center">
                                <div class="col-2">
                                    <i class="bi bi-building" style="font-size: 1.5rem"></i>
                                </div>
                                <div class="col text-truncate">
                                    Улица {{ address.street }}, {{ address.house }}{{ address.building }}
                                </div>
                                <div class="col-2">
                                    <a href="" class="link-dark" data-bs-toggle="modal" data-bs-target="#EditModal{{ address.id }}">
                                        <i class="bi bi-pencil" style="font-size: 1.5rem"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal fade" id="EditModal{{ address.id }}" tabindex="-1">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header border-0">
                                    <h5 class="modal-title" id="exampleModalLabel">Адрес доставки</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>
                                <div class="modal-body">
                                    <form action="" method="post" novalidate>
                                        {{ address_form.hidden_tag() }}
                                        <div class="row g-3">
                                            {{ address_form.address_id(type="hidden", class_="form-control", id="InputID", value=address.id) }}
                                            <div class="col-md-6">
                                                {{ address_form.street.label(class_="form-label", for="InputStreet") }}
                                                {{ address_form.street(class_="form-control", id="InputStreet", value=address.street) }}
                                                {% for error in address_form.street.errors %}
                                                    <span style="color: red;">{{ error }}</span>
                                                {% endfor %}
                                            </div>
                                            <div class="col-md-6">
                                                {{ address_form.house.label(class_="form-label", for="InputHouse") }}
                                                {{ address_form.house(class_="form-control", id="InputHouse", value=address.house) }}
                                                {% for error in address_form.house.errors %}
                                                    <span style="color: red;">{{ error }}</span>
                                                {% endfor %}
                                            </div>
                                            <div class="col-md-6">
                                                {{ address_form.building.label(class_="form-label", for="InputBuilding") }}
                                                {{ address_form.building(class_="form-control", id="InputBuilding", value=address.building) }}
                                            </div>
                                            <div class="col-md-6">
                                                {{ address_form.entrance.label(class_="form-label", for="InputEntrance") }}
                                                {{ address_form.entrance(class_="form-control", id="InputEntrance", value=address.entrance) }}
                                            </div>
                                            <div class="col-md-6">
                                                {{ address_form.floor.label(class_="form-label", for="InputFloor") }}
                                                {{ address_form.floor(class_="form-control", id="InputFloor", value=address.floor) }}
                                            </div>
                                            <div class="col-md-6">
                                                {{ address_form.apartment.label(class_="form-label", for="InputApartment") }}
                                                {{ address_form.apartment(class_="form-control", id="InputApartment", value=address.apartment) }}
                                            </div>
                                            <div class="col-12">
                                                {{ address_form.additional_info.label(class_="form-label", for="InputAdditionalInfo") }}
                                                {{ address_form.additional_info(class_="form-control", id="InputAdditionalInfo", value=address.additional_info) }}
                                            </div>
                                        </div>
                                        <div class="modal-footer border-0 position-relative">
                                            {{ address_form.delete_address(class_="btn btn-danger position-absolute start-0") }}
                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть</button>
                                            {{ address_form.edit_address(class_="btn btn-primary") }}
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %} 
            </div>
        </div>
    </div>
{% endblock %}